
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>How to Press on Links to Open App Using Swift? Universal Links in iOS9 - Geek Is Stupid</title>
  <meta name="author" content="Le Tai">

  
  <meta name="description" content="In iOS 9, your app can register to open web links (using https or http) directly, bypassing Safari. Here is the process to add Universal Links: A. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://geek-is-stupid.github.io/blog/2015/10/23/how-to-press-on-links-to-open-app-using-swift-universal-links-in-ios9">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Geek Is Stupid" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Geek Is Stupid</a></h1>
  
    <h2>Do crazy things...</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
  
  
  
  
  
    
      <form action="https://www.google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="sitesearch" value="geek-is-stupid.github.io" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">How to Press on Links to Open App Using Swift? Universal Links in iOS9</h1>
      
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-10-23T23:51:20+07:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>11:51 pm</span></time>
        
        
      </p>
    
  </header>


<div class="entry-content"><p>In iOS 9, your app can register to open web links (using https or http) directly, bypassing Safari. Here is the process to add Universal Links:
<a href="https://stackoverzone.files.wordpress.com/2015/10/universal_links.png"><img align='center' src="https://stackoverzone.files.wordpress.com/2015/10/universal_links.png" alt="universal_links" /></a></p>

<h1>A. Generate apple-site-app-association file</h1>


<h3>1. CreateÂ Server-side web credentials file: <code>handoff.json</code></h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="nt">&quot;applinks&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nt">&quot;apps&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span class='line'>        <span class="nt">&quot;details&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nt">&quot;TEAM_ID.App-Bundle-ID&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>                <span class="nt">&quot;paths&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">]</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>2. Download your certificate at <a href="https://developer.apple.com/account/ios/certificate/certificateList.action" target="_blank">here</a>, and when it is downloaded, double click on it to add into KeyChain app</h3>

<h3>3. Right click on your certificate in KeyChain to export your Certificates.p12</h3>

<p><a href="https://stackoverzone.files.wordpress.com/2015/10/11.png"><img align='center' src="https://stackoverzone.files.wordpress.com/2015/10/11.png" alt="1" /></a></p>

<p><a href="https://stackoverzone.files.wordpress.com/2015/10/2.png"><img align='center' src="https://stackoverzone.files.wordpress.com/2015/10/2.png" alt="2" /></a></p>

<h3>4. Open terminal to create certificates with openssl commands:</h3>

<h4>4.1. Create the certificate:</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">openssl</span> <span class="n">pkcs12</span> <span class="o">-</span><span class="k">in</span> <span class="n">Certificates</span><span class="p">.</span><span class="n">p12</span> <span class="o">-</span><span class="n">clcerts</span> <span class="o">-</span><span class="n">nokeys</span> <span class="o">-</span><span class="k">out</span> <span class="n">output_crt</span><span class="p">.</span><span class="n">pem</span>
</span></code></pre></td></tr></table></div></figure>


<h4>4.2. Create the secret key:</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">openssl</span> <span class="n">pkcs12</span> <span class="o">-</span><span class="k">in</span> <span class="n">Certificates</span><span class="p">.</span><span class="n">p12</span> <span class="o">-</span><span class="n">nocerts</span> <span class="o">-</span><span class="n">nodes</span> <span class="o">-</span><span class="k">out</span> <span class="n">output_key</span><span class="p">.</span><span class="n">pem</span>
</span></code></pre></td></tr></table></div></figure>


<h4>4.3. Create the intermediate certificate:</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">openssl</span> <span class="n">pkcs12</span> <span class="o">-</span><span class="k">in</span> <span class="n">Certificates</span><span class="p">.</span><span class="n">p12</span> <span class="o">-</span><span class="n">cacerts</span> <span class="o">-</span><span class="n">nokeys</span> <span class="o">-</span><span class="k">out</span> <span class="n">sample</span><span class="p">.</span><span class="n">ca</span><span class="o">-</span><span class="n">bundle</span>
</span></code></pre></td></tr></table></div></figure>


<h3>5. Sign the <code>handoff.json</code> file with the following command:</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">cat</span> <span class="n">handoff</span><span class="p">.</span><span class="n">json</span> <span class="o">|</span> <span class="n">openssl</span> <span class="n">smime</span> <span class="o">-</span><span class="n">sign</span> <span class="o">-</span><span class="n">inkey</span> <span class="n">output_key</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">signer</span> <span class="n">output_crt</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">certfile</span> <span class="n">sample</span><span class="p">.</span><span class="n">ca</span><span class="o">-</span><span class="n">bundle</span> <span class="o">-</span><span class="n">noattr</span> <span class="o">-</span><span class="n">nodetach</span> <span class="o">-</span><span class="n">outform</span> <span class="n">DER</span><span class="o">&gt;</span> <span class="n">apple</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">site</span><span class="o">-</span><span class="n">association</span>
</span></code></pre></td></tr></table></div></figure>


<h3>6. Upload your <code>apple-site-app-association</code> file to the root of your web-site</h3>

<p>e.g. <a href="https://example.com/apple-app-site-association" target="_blank"><a href="https://example.com/apple-app-site-association">https://example.com/apple-app-site-association</a></a>.</p>

<p><strong>Make sure Content-Type of this file is:</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">application</span><span class="o">/</span><span class="n">pkcs7</span><span class="o">-</span><span class="n">mime</span>
</span></code></pre></td></tr></table></div></figure>




<h1>B. Xcode setting</h1>


<p><a href="https://stackoverzone.files.wordpress.com/2015/10/3.png"><img src="https://stackoverzone.files.wordpress.com/2015/10/3.png" alt="3" /></a></p>

<ol>
<li>Select your project in the Navigator area</li>
<li>Select your Target in the Editor area</li>
<li>In the Editor area select the Capabilities option from the menu bar</li>
<li>Open the disclosure button to the left of the Associated Domains</li>
<li>Under Associated Domains select the &ldquo;+&rdquo; button</li>
<li>Type the entitlement in the input area:</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="nl">applinks</span><span class="p">:</span><span class="o">&lt;</span><span class="n">your</span><span class="o">-</span><span class="n">domain</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="nl">applinks</span><span class="p">:</span><span class="n">geek</span><span class="o">-</span><span class="kt">is</span><span class="o">-</span><span class="n">stupid</span><span class="p">.</span><span class="n">github</span><span class="p">.</span><span class="n">io</span>
</span></code></pre></td></tr></table></div></figure>




<h1>C. App implement</h1>


<p>In <code>AppDelegate.swift</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">func</span> <span class="n">application</span><span class="p">(</span><span class="nl">application</span><span class="p">:</span> <span class="bp">UIApplication</span><span class="p">,</span> <span class="n">continueUserActivity</span> <span class="nl">userActivity</span><span class="p">:</span> <span class="n">NSUserActivity</span><span class="p">,</span> <span class="nl">restorationHandler</span><span class="p">:</span> <span class="p">([</span><span class="n">AnyObject</span><span class="p">]</span><span class="o">?</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Void</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="k">let</span> <span class="n">webpageURL</span> <span class="o">=</span> <span class="n">userActivity</span><span class="p">.</span><span class="n">webpageURL</span> <span class="k">where</span> <span class="n">userActivity</span><span class="p">.</span><span class="n">activityType</span> <span class="o">==</span> <span class="n">NSUserActivityTypeBrowsingWeb</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// Your handle links code here :D</span>
</span><span class='line'>        <span class="k">return</span> <span class="nb">true</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">false</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<h1>D. Test on localhost</h1>


<p>The Universal link never works with links as: <a href="http://localhost:8080"><a href="http://localhost:8080">http://localhost:8080</a></a></p>

<h4>1. Launch the plugin at Root:</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">atlas</span><span class="o">-</span><span class="n">run</span> <span class="o">--</span><span class="n">context</span><span class="o">-</span><span class="n">path</span> <span class="n">ROOT</span>
</span></code></pre></td></tr></table></div></figure>


<h4>2. Change the local host link to pure link by using <a href="https://ngrok.com/" target="_blank">ngrok</a>:</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">ngrok</span> <span class="o">&lt;</span><span class="n">port_number</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Example for [<a href="http://localhost:8080">http://localhost:8080</a>]</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">ngrok</span> <span class="mi">8080</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3. Your local host link will become: <a href="http://xxxxxxxx.ngrok.com"><a href="http://xxxxxxxx.ngrok.com">http://xxxxxxxx.ngrok.com</a></a></h4>

<h4>4. Re-configuring Associated Domains in Xcode to start testing</h4>

<h1>Drawbacks of Universal Links</h1>


<ol>
<li>Work only for iOS9+</li>
<li>We need to upload the file apple-app-site-association located at: <a href="https://domain.com/apple-app-site-association"><a href="https://domain.com/apple-app-site-association">https://domain.com/apple-app-site-association</a></a></li>
<li>Just support static domains, not dynamic domains, not sub-domains</li>
<li>To make a trust relationship between the app and the website, we need add the domains of the websites into  Associated Domains entitlement first, and then we can specific which paths from our websites should be handled as universal links, BUT we have a lot of customer&rsquo;s domains and they are different, so we can not register all of them into Associated Domains entitlement</li>
<li>Uptil Beta 4, you need to sign the <code>app-site-association</code> json file before upload, Apple is planning to do away with this in next Beta/GM.</li>
</ol>

</div>


  <footer>
    <p class="meta">
      
  



  <span class="byline author vcard">Authored by <span class="fn">
  
    Le Tai
  
  </span></span>


      




<time class='entry-date' datetime='2015-10-23T23:51:20+07:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>11:51 pm</span></time>
      
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://geek-is-stupid.github.io/blog/2015/10/23/how-to-press-on-links-to-open-app-using-swift-universal-links-in-ios9/" data-via="" data-counturl="http://geek-is-stupid.github.io/blog/2015/10/23/how-to-press-on-links-to-open-app-using-swift-universal-links-in-ios9/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/10/23/xcode-7-error-include-of-non-modular-header-inside-framework-module-with-a-lib/" title="Previous Post: Xcode 7.1 error: Include of non-modular header inside framework module...">&laquo; Xcode 7.1 error: Include of non-modular header inside framework module...</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/10/23/what-difference-between-frame-and-bounds/" title="Next Post: What difference between 'frame' and 'bounds'?">What difference between 'frame' and 'bounds'? &raquo;</a>
      
    </p>
  </footer>
</article>


</div>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Le Tai -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  










  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
